<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance System — Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=7">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}?v=7">
</head>
<body class="admin-body">
    <aside class="sidebar" aria-label="Main navigation">
        <div class="sidebar-brand">
            <div class="sidebar-logo-wrap">
                <span class="sidebar-logo-icon" aria-hidden="true">◈</span>
                <h1 class="sidebar-logo">Attendance</h1>
            </div>
            <span class="sidebar-tagline">Admin Dashboard</span>
        </div>
        <nav class="sidebar-nav">
            <button type="button" class="nav-item active" data-page="dashboard" aria-current="page">
                <span class="nav-icon" aria-hidden="true">▢</span> Dashboard
            </button>
            <button type="button" class="nav-item" data-page="sections">
                <span class="nav-icon" aria-hidden="true">▣</span> Sections
            </button>
            <button type="button" class="nav-item" data-page="students">
                <span class="nav-icon" aria-hidden="true">☺</span> Students
            </button>
            <button type="button" class="nav-item" data-page="mark">
                <span class="nav-icon" aria-hidden="true">✓</span> Mark Attendance
            </button>
            <button type="button" class="nav-item" data-page="records">
                <span class="nav-icon" aria-hidden="true">≡</span> Records
            </button>
            <button type="button" class="nav-item" data-page="settings">
                <span class="nav-icon" aria-hidden="true">⚙</span> Settings
            </button>
            <button type="button" class="nav-item nav-item-logout" data-page="logout">
                <span class="nav-icon" aria-hidden="true">→</span> Logout
            </button>
        </nav>
    </aside>
    <main class="main-content" id="mainContent">
        <!-- Pages injected by JS -->
        <div id="pageDashboard" class="page active"></div>
        <div id="pageSections" class="page"></div>
        <div id="pageStudents" class="page"></div>
        <div id="pageMark" class="page"></div>
        <div id="pageRecords" class="page"></div>
        <div id="pageSettings" class="page"></div>
    </main>

    <!-- Toast container -->
    <div id="toastContainer" class="toast-container" aria-live="polite"></div>

    <!-- Chat: floating button + slide-in panel -->
    <button type="button" id="chatFloatingBtn" class="chat-floating-btn" aria-label="Open Attendance Assistant" title="Attendance Assistant">
        <svg class="chat-btn-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>
    </button>
    <div id="chatPanel" class="chat-panel" aria-hidden="true">
        <header class="chat-header">
            <div class="chat-header-text">
                <h2 class="chat-title">Attendance Assistant</h2>
                <p class="chat-subtitle">Ask about sections, students, or today’s attendance</p>
            </div>
            <button type="button" id="chatCloseBtn" class="chat-close-btn" aria-label="Close chat">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
            </button>
        </header>
        <div class="chat-body">
            <div id="chatWelcome" class="chat-welcome">
                <p class="chat-welcome-text">How can I help you today?</p>
                <div class="chat-suggestions" id="chatSuggestions">
                    <button type="button" class="chat-chip" data-msg="How many students are in each section?">Sections overview</button>
                    <button type="button" class="chat-chip" data-msg="Who was absent today?">Absent today</button>
                    <button type="button" class="chat-chip" data-msg="Give me a summary of today's attendance">Today’s summary</button>
                </div>
            </div>
            <div id="chatMessages" class="chat-messages" role="log" aria-live="polite"></div>
        </div>
        <footer class="chat-footer">
            <input type="text" id="chatInput" class="chat-input" placeholder="Ask about attendance…" maxlength="1000" autocomplete="off">
            <button type="button" id="chatSendBtn" class="chat-send-btn" aria-label="Send">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></svg>
            </button>
        </footer>
    </div>

    <!-- Modals -->
    <div id="modalSection" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal-panel">
            <h2 id="modalSectionTitle" class="modal-title">Add Section</h2>
            <form id="formSection">
                <div class="form-group">
                    <label for="sectionName">Section name</label>
                    <input type="text" id="sectionName" required placeholder="e.g. ECE A" autocomplete="off">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary btn-cancel-section">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modalStudent" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal-panel">
            <h2 id="modalStudentTitle" class="modal-title">Add Student</h2>
            <form id="formStudent">
                <input type="hidden" id="studentId" value="">
                <div class="form-group">
                    <label for="studentSection">Section</label>
                    <select id="studentSection" required></select>
                </div>
                <div class="form-group">
                    <label for="studentRollNo">Roll number</label>
                    <input type="text" id="studentRollNo" required placeholder="e.g. 101" autocomplete="off">
                </div>
                <div class="form-group">
                    <label for="studentName">Name</label>
                    <input type="text" id="studentName" required placeholder="Full name" autocomplete="name">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary btn-cancel-student">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modalConfirm" class="modal-overlay" aria-hidden="true" role="dialog">
        <div class="modal-panel modal-panel-sm">
            <h2 class="modal-title" id="modalConfirmTitle">Confirm</h2>
            <p id="modalConfirmBody" class="modal-body"></p>
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="btnConfirmCancel">Cancel</button>
                <button type="button" class="btn btn-danger" id="btnConfirmOk">Delete</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}?v=7"></script>
</body>
</html>
